#!/bin/sh
#
# Copyright (C) 2008 Jonathan Moore Liles
# This file is licensed under version 2 of the GPL.

. scripts/config-funcs

begin

begin_options

echo "Master configuration"

ask "Installation prefix" prefix /usr/local
ask "Build for debugging" USE_DEBUG no

begin_tests

# should require everything all of the subprojects require

require_command ar ar
require_command makedepend makedepend
require_FLTK 1.3.0 images
require_command FLUID lib/fltk/fluid/fluid
require_package JACK 0.103.0 jack
test_version `version_of jack` 0.105.0 || append "JACK_MIDI_PROTO_API=yes"
require_package sndfile 1.0.17 sndfile
require_package lrdf 0.4.0 lrdf
require_package liblo 0.23 liblo
suggest_package XPM 2.0.0 xpm
require_package sigcpp 2.0.0 sigc++-2.0

test_version `version_of liblo` 0.26 || warn "Version $(version_of liblo) of liblo is slow to create servers. Consider upgrading to 0.26 or later"

if ! hostname_resolvable
then
    echo "Your hostname \"$(hostname)\" does not resolve to a valid address."
    echo "This is a broken configuration and will cause liblo (the"
    echo "OSC library) to fail to function. Add the line:"
    echo
    echo "127.0.0.1 $(hostname)"
    echo
    echo "to your /etc/hosts file to fix. And consider switching to a saner distribution."
    echo
    fail "Invalid hostname!"
fi

end

# installing configuration
echo -n "Copying configuration to modules..."

for i in nonlib FL timeline mixer sequencer session-manager
do
    echo -n "$i "
    cp .config "$i"
done

echo
